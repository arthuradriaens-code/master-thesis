\documentclass[11pt,a4paper,faculty=we,language=en,doctype=report]{cls/ugent-doc}

% Optional: margins and spacing
%-------------------------------
% Uncomment and adjust to change the default values set by the template
% Note: the defaults are suggested values by Ghent University
%\geometry{bottom=2.5cm,top=2.5cm,left=3cm,right=2cm} 
%\renewcommand{\baselinestretch}{1.15} % line spacing
\setlength{\headheight}{13.59999pt}

% Font
%------
%\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc} % allows non-ascii input characters
\usepackage{tikz-feynman}
% Comment or remove the two lines below to use the default Computer Modern font
%\usepackage{libertine}
%\usepackage{libertinust1math}

%\usepackage[sc]{mathpazo} %font or smth
\linespread{1.05}
%\usepackage{microtype}

\usepackage{fancyhdr} % Headers and footers
\pagestyle{fancy} % All pages have headers and footers e.g contents above contents (except new ones)
\usepackage[Rejne]{fncychap} %fancy chapters
%options for chapters: Sonny, Lenny, Glenn, Conny, Rejne, Bjarne, Bjornstrup

% NOTE: because the UGent font Panno is proprietary, it is not possible to use it
% in Overleaf. But UGent does not suggest to use Panno for documents (or maybe only for
% the titlepage). For the body, the UGent suggestion is to use a good serif font (for
% LaTeX this could be libertine or Computer Modern).
\usepackage{slashed}
\usepackage{braket}

% Proper word splitting
%-----------------------
\usepackage[english]{babel} 

% Mathematics
%-------------
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{mathrsfs}
% Figures
%---------
%\usepackage{graphicx} % optional: the package is already loaded by the template
\graphicspath{{./figures/}}
\usepackage{copyrightbox}
% Bibliography settings
%-----------------------
\usepackage{cite}

% Hyperreferences
%-----------------
\usepackage[colorlinks=true, allcolors=ugentblue]{hyperref}

% Whitespace between paragraphs and no indentation
%--------------------------------------------------
\usepackage[parfill]{parskip} 

% Input for title page
%----------------------

% The title
\thetitle{Radio detection of high energy neutrinos in the Greenland icecap}
\thesubtitle{Arthur Adriaens}

%% Note: a stricter UGent style could be achieved with, e.g.:
\usepackage{ulem} % for colored underline
\renewcommand{\ULthickness}{2pt} % adjust thickness of underline
\thetitle{\uline{\color{ugentblue}Radio detection of high energy neutrinos in the Greenland icecap}}
% Note: do not forget to reset the \ULthickness to 1pt after invoking \maketitle
% (otherwise all underlines in the rest of your document will be too thick):
%\renewcommand{\ULthickness}{1pt}

% The first (top) infobox at bottom of titlepage
\infoboxa{\bfseries\large Department of Physics and Astronomy}

% The second infobox at bottom of titlepage
\infoboxb{Promotor: 
\begin{tabular}[t]{ll}
    Prof. dr. Dirk Ryckbosch & Dirk.Ryckbosch@ugent.be\\ % note syntax 'short space'
\end{tabular}
}

% The third infobox at bottom of titlepage
\infoboxc{Accompanist: 
\begin{tabular}[t]{ll}
    Bob Oeyen &  Bob.Oeyen@ugent.be\\
\end{tabular}
}

% The last (bottom) infobox at bottom of titlepage
\infoboxd{Academic year: 2022--2023} % note dash, not hyphen
\infoboxd{Master’s dissertation submitted in partial fulfilment of the requirements for the degree of master in Physics and Astronomy}

\begin{document}

% =====================================================================
% Cover
% =====================================================================

% ------------ TITLE PAGE ---------
\maketitle
\renewcommand{\ULthickness}{1pt}

% =====================================================================
% Front matter
% =====================================================================

% ------------ TABLE OF CONTENTS ---------
{\hypersetup{hidelinks}\tableofcontents} % hide link color in toc
\newpage


% =====================================================================
% Main matter
% =====================================================================
\chapter{Foreword}
\section{Abstract: English}
The Radio Neutrino Observatory in Greenland - RNO-G - is under construction at Summit Station in Greenland to search for neutrinos of several PeV energy up to the Eev range. It's a mid-scale, discovery phase, extremely high-energy neutrino telescope that will probe the astrophysical neutrino flux at energies beyond the reach of IceCube.
More particularly if will make it possible to reach the next major milestone in astroparticle physics: the discovery of cosmogenic neutrinos.
\vspace{0.5cm}
All simulations carried out within this work were made with the three programs 
\begin{itemize}
	\item NuRadioMC
	\item radiotools
	\item RadioPropa
\end{itemize}
whom are free to download on \href{https://github.com/nu-radio}{github}.
The projects built over the course of this thesis were the "Hybrid minimizer": a new
algorithm for finding the path of a neutrino interaction to the detector in complex ice models
and (...)
\section{Abstract: Nederlands}
De \textit{Radio Neutrino Observatory in Greenland} - RNO-G - is een detector die momenteel onder constructie is
in Groenland. Deze detector heeft als doel het vinden van neutrino's met energieën van enkele PeV
tot in het EeV gebied. Deze extreem hoge energy neutrino telescoop zal astrofysische neutrinos
zoeken op energieën waar icecube te klein voor is. Het zal ook het vinden van cosmogenische
neutrinos mogelijk maken.
Alle simulaties werden mogelijk gemaakt door de volgende programmas:
\begin{itemize}
	\item NuRadioMC
	\item radiotools
	\item RadioPropa
\end{itemize}
Dewelke te downloaden zijn op \href{https://github.com/nu-radio}{github}
De projecten die tot completie zijn gebracht over deze master thesis waren de
\textit{Hybrid minimizer}: een algoritme gemaakt met als doel het snel vinden van
een pad vanuit de interactievertex tot de detector in complexe ijsmodellen en
(...)
% =====================================================================
\chapter{Neutrinos}
%\includegraphics[width=0.5\textwidth]{standard_model.png}
Neutrinos are fermions who only interact
via the weak force and gravity.
\section{Discovery}
When researching beta decay, the decay of a neutron, researcher
detected a proton and an electron coming from the neutron. However
on closer inspection it became apparent that energy was lost
somewhere in violation with the conservation law of energy, and
angular momentum wasn't conserved.  The solution postulated by
Wolfgang Pauli was to introduce a new, really hard to detect
particle: the neutrino.  The neutrino comes in three flavours:
electron, muon and tau neutrinos, each corresponding to their
respective lepton 
and each again having an anti-particle as to make it possible to conserve lepton number.
Now with the introduction of the neutrino the full beta decay
becomes
\begin{equation}
	n \rightarrow p^+ + e^- + \nu_e
\end{equation}
\section{Neutrino sources}

\section{Do neutrinos have mass?}
Neutrinos get produced through the following ways in the nucleus of our star:\\
$\bold{pp-cycle}$
\begin{align}
	\mathrm{p} + \mathrm{p} &\rightarrow \mathrm{D} + e^+ + \nu_e\\
	\mathrm{D} + \mathrm{p} &\rightarrow {}^3\mathrm{He} + \gamma\\
	{}^3\mathrm{He} + {}^3\mathrm{He} &\rightarrow {}^4\mathrm{He} + \mathrm{p} + \mathrm{p}
\end{align}\\
$\bold{boron-cycle}$
\begin{align}
{ }^4 \mathrm{He}+{ }^3 \mathrm{He} & \rightarrow{ }^7 \mathrm{Be}+\gamma \\
{ }^7 \mathrm{Be}+p & \rightarrow { }^8\mathrm{B} + \gamma \\
{ }^8 \mathrm{B} & \rightarrow{ }^8 \mathrm{Be}^*+e^{+}+\nu_e \\
{ }^8 \mathrm{Be}^* & \rightarrow{ }^4 \mathrm{He}+{ }^4 \mathrm{He}
\end{align}\\
$\bold{Be-capture}$
\begin{align}
	^7\mathrm{Be} + e^- \rightarrow {}^7\mathrm{Li} + \nu_e
\end{align}
$\bold{pep}$
\begin{align}
	\mathrm{p} + e^- + \mathrm{p} \rightarrow \mathrm{D} + \nu_e
\end{align}\\
Now with this and some information about the sun like the pressure and mass, 
the so-called "standard solar model" was
made. This model predicted a certain amount of neutrinos to be hitting the earth from the previously
mentioned thermonuclear fusion, it was however 3 times higher than the observed amount of neutrinos back
at our planet. Through various experiments it became apparent that this was due to the various kind of
neutrinos oscillating into each other, i.e 2/3 of the original electron 
neutrinos had oscillated into mu and tau neutrinos
but for them to oscillate into eachother, they require mass:
\subsection{neutrino oscillations}
So the transition probability is
\begin{equation}
	P(\nu_e\rightarrow\nu_\mu) = |\braket{\nu_\mu|\psi(L,T)}|^2 = c_\mu c_\mu^* = \sin ^2(2 \theta) \sin ^2\left(\frac{\Delta \phi_{12}}{2}\right)
\end{equation}
with
\begin{equation}
	\Delta \phi_{12} \approx \frac{m_1^2 - m_2^2}{2p}L
\end{equation}
I.e not only mass but difference in mass of the eigenstates is a requirement for oscillations to occur.
In general
\begin{equation}
	\ket{\nu_\alpha} = \sum_iU_{\alpha i} \ket{\nu_i}
\end{equation}
With $U_{\alpha i}$ e.g the Pontecorvo-Maki-Nakagawa-Sakata (PMNS) matrix. 
This phenomenon has been observed e.g from the descrepency from the observed
and expected neutrino events coming from a nuclear reactor \cite{Eguchi_2003}.
Now the question remains, how do neutrinos get their mass (theoretically)?
\subsection{See-saw mechanism}
We can give neutrino's mass as with any other spinor throught Yukawa couplings and an extra term:
\begin{equation}
	\mathcal{L} = i\bar{\nu}\slashed{\partial}\nu - m\bar{\psi}\nu - \frac{M}{2} (\bar{\nu}_R\nu_{Rc} + \bar{\nu}_{Rc}\nu_R)
\end{equation}
More general, given a spinor $\psi$ with the following Lagrange density:
\begin{equation}
	\mathcal{L} = i\bar{\psi}\slashed{\partial}\psi - m\bar{\psi}\psi - \frac{M}{2} (\bar{\psi}_R\psi_{Rc} + \bar{\psi}_{Rc}\psi_R)
\end{equation}
We can re-write this Lagrangian in terms of
\begin{align}
	\chi &:= \frac{1}{\sqrt{2}} (\psi_R + \psi_{Rc})\\
	\omega &:= \frac{1}{\sqrt{2}} (\psi_L + \psi_{Lc})
\end{align}
by first identifying that
\begin{equation}
	- \frac{M}{2} (\bar{\psi}_R\psi_{Rc} + \bar{\psi}_{Rc}\psi_R)
\end{equation}
is equal to
\begin{equation}
	-M\bar{\chi} \chi = -\frac{M}{2} (\bar{\psi}_R + \bar{\psi}_{Rc}) (\psi_R + \psi_{Rc}) = -\frac{M}{2} (\bar{\psi}_R\psi_{Rc} + \bar{\psi}_{Rc}\psi_R)
\end{equation}
Where we've used
\begin{equation}
	\bar{\psi}_R\psi_{R} \equiv \psi_R^\dagger\gamma^0\psi_{R} \equiv P_R\psi^\dagger\gamma^0P_R\psi = P_RP_L\psi^\dagger\gamma^0\psi = 0
\end{equation}
And next that in
\begin{equation}
	i\bar{\psi}\slashed{\partial}\psi - m\bar{\psi}\psi = i\bar{\psi}_R\slashed{\partial}\psi_{R} + i\bar{\psi}_L\slashed{\partial}\psi_{L} - m\bar{\psi}_R\psi_{L} - m\bar{\psi}_L\psi_{R}
\end{equation}
We can identify that
\begin{align}
	\bar{\chi}\slashed{\partial}\chi &= \frac{1}{2}(\bar{\psi}_R\slashed{\partial}\psi_{R} + \bar{\psi}_{Rc}\slashed{\partial}\psi_{Rc}) = \bar{\psi}_R \slashed{\partial} \psi_{R}\\
	\bar{\omega}\slashed{\partial}\omega &= \bar{\psi}_L \slashed{\partial} \psi_{L}
\end{align}
Where we've done an integration by parts and used $\bar{\psi}_c\gamma_\mu\chi_c = -\bar{\chi}\gamma_\mu\psi$. We thus get:
\begin{equation}
	\mathcal{L} = i\bar{\chi}\slashed{\partial}\chi +i\bar{\omega}\slashed{\partial}\omega - m\bar{\psi}_R\psi_{L} - m\bar{\psi}_L\psi_{R} -M\bar{\chi} \chi 
\end{equation}
And finally we notice that
\begin{align}
	\bar{\chi}\omega &= \frac{1}{2} \left(\bar{\psi}_R\psi_L + \bar{\psi}_R\psi_{Lc} + \bar{\psi}_{Rc}\psi_{L} + \bar{\psi}_{Rc}\psi_{Lc}\right)\\
	&=  \frac{1}{2} \left(\bar{\psi}_R\psi_L + \bar{\psi}_R\psi_{Lc} + \bar{\psi}_{Rc}\psi_{L} + \bar{\psi}_{L}\psi_{R}\right)\\
	\bar{\omega}\chi &= \frac{1}{2} \left(\bar{\psi}_L \psi_{R} + \bar{\psi}_{Lc}\psi_{R} + \bar{\psi}_L\psi_{Rc} + \bar{\psi}_{Lc}\psi_{Rc}\right)\\
	&= \frac{1}{2} \left(\bar{\psi}_L \psi_{R} + \bar{\psi}_{Lc}\psi_{R} + \bar{\psi}_L\psi_{Rc} + \bar{\psi}_{R}\psi_{L}\right)
\end{align}
As $\bar{\psi}_c\chi_c = \bar{\chi}\psi$. Summing these, we get:
\begin{align}
	\bar{\chi}\omega + \bar{\omega}\chi &= \bar{\psi}_L \psi_R + \bar{\psi}_R \psi_{L}\\
	&\quad + \frac{1}{2}\left(\bar{\psi}_R\psi_{Lc} + \bar{\psi}_{Rc} \psi_{L} + \bar{\psi}_{Lc}\psi_R + \bar{\psi}_L\psi_{Rc}\right)\\
	&= \bar{\psi}_L \psi_R + \bar{\psi}_R \psi_{L}
\end{align}
Where we've used the handedness flips a charge conjugation entails, at last we now have:
\begin{equation}
	\mathcal{L} = i\bar{\chi}\slashed{\partial}\chi +i\bar{\omega}\slashed{\partial}\omega - m(\bar{\chi}\omega + \bar{\omega}\chi) -M\bar{\chi} \chi 
\end{equation}
Now to determine the mass eigenstates we'll re-write this equation into the form
\begin{equation}
	\mathcal{L} = i\bar{\chi}\slashed{\partial}\chi +i\bar{\omega}\slashed{\partial}\omega 
	-\left(\begin{array}{cc}
		\bar{\chi} &\bar{\omega}
	\end{array}\right)\cdot
	\left(\begin{array}{cc}
		M & m \\
		m & 0
	\end{array}\right) \cdot \left(\begin{array}{c}
	\chi \\ \omega
\end{array}\right)
\end{equation}
lets now find the eigenvalues:
\begin{equation}
	\left| \begin{array}{cc}
		M-\lambda & m \\
		m & -\lambda
	\end{array} \right| = (\lambda-M)\lambda - m^2 = 0 \implies \lambda_\pm  = \frac{M\pm \sqrt{M^2 + 4m^2}}{2} \label{eigenvalues}
\end{equation}
i.e
\begin{equation}
	\lambda_\pm = \frac{M}{2}\left( 1 \pm \sqrt{1 + 4m^2/M^2}\right)
\end{equation}
Now we'll determine the eigenvectors:
\begin{equation}
\left[\begin{array}{cc}
	M-\lambda_\pm & m \\
	m & -\lambda_\pm
\end{array}\right] \left(\begin{array}{c}
x_\pm \\
y_\pm
\end{array}\right) = \vec{0}
\end{equation}
this gives
\begin{align}
	Mx_\pm - \lambda_\pm x_\pm + my_\pm &= 0\\
	m x_\pm - \lambda_\pm y_\pm &= 0 \implies \frac{m x_\pm}{\lambda_\pm} = y_\pm
\end{align}
inserting the second equation in the first we get:
\begin{align}
	Mx_\pm - \lambda_\pm x_\pm + m \frac{m x_\pm}{\lambda_\pm} = 0 &= M\lambda_\pm x_\pm - \lambda_\pm^2 x_\pm + m^2 x_\pm\\
	&= x_\pm(\lambda_\pm^2 -M\lambda_\pm + m^2)
\end{align}
which is true for every $x_\pm$ (see equation \ref{eigenvalues}) i.e we can freely choose $x_\pm$ so let's opt for $x_\pm^2 + y_\pm^2 = 1$:
\begin{align}
	x_\pm^2(1+\frac{m^2}{\lambda_\pm^2}) = 1 \implies x^2_\pm = \frac{1}{1+\frac{m^2}{\lambda_\pm^2}} \implies x_\pm &= \frac{\lambda_\pm}{\sqrt{\lambda_\pm^2 + m^2}}\\
	\& \quad y_\pm &= \frac{m}{\sqrt{\lambda_\pm^2 + m^2}}
\end{align}
And thus, summing up, we get the eigenvectors $\phi_\pm$ with eigenvalues $m_\pm$:
\begin{equation}
	\phi_\pm := \left(\begin{array}{c}
		x_\pm\\
		y_\pm
	\end{array}\right) = \left(\begin{array}{c}
		\frac{\lambda_\pm}{\sqrt{\lambda_\pm^2 + m^2}}\\
		\frac{m}{\sqrt{\lambda_\pm^2 + m^2}}
	\end{array}\right) \quad \text{ and }\quad m_\pm := \lambda_\pm =  \frac{M}{2}\left( 1 \pm \sqrt{1 + 4m^2/M^2}\right)
\end{equation}
Now we'll consider the limit $M \gg m$:
\begin{equation}
	m_\pm =  \frac{M}{2}\left( 1 \pm \sqrt{1 + 4m^2/M^2}\right) \approx \frac{M}{2}\left(1\pm1\pm\frac{2m^2}{M^2}\right)
\end{equation}
Which gives:
\begin{align}
	m_+ &\approx M\\
	m_- &\approx -\frac{m^2}{M}
\end{align}
and:
\begin{align}
	\phi_+&\approx \left(\begin{array}{c}
		\frac{M}{M}\\
		\frac{m}{M}
	\end{array}\right) = \left(\begin{array}{c}
	1\\
	m/M
	\end{array}\right)\\
	\phi_-&\approx \left(\begin{array}{c}
		-\frac{m}{M}\\
		\frac{m}{m}
	\end{array}\right) = \left(\begin{array}{c}
		-m/M\\
		1
	\end{array}\right)
\end{align}
i.e, in the $\chi,\omega$ basis:
\begin{align}
	m_+\approx M \quad &\text{with eigenstate} \quad \chi + \frac{m}{M}\omega\\
	m_-\approx -\frac{m^2}{M} \quad &\text{with eigenstate} \quad  \omega - \frac{m}{M}\chi\\
\end{align}
This is what's called the See-Saw mechanism, it's both a theory of giving mass to
neutrinos and explaining their small mass.  
For a certain $m$ if we choose a big $M$ we'll
get a big $m_+$ and small $m_-$ (and vice versa). We also see that there's only
a very small mixing of states, i.e the $m_-$ mass state is almost purely
$\omega$ (and $m_+$ almost purely $\chi$). The parameter $m$ in the original
matrix is forbidden by electroweak gauge symmetry, and can only appear after
the symmetry has been spontaneous broken by a Higgs mechanism; for this reason
a good estimate of the order of $m$ is the vaccuum expectation energy:
$m\approx v = 246 \approx 10^2$GeV. In grand unified theories it's theorised
that $M\approx 10^{15}$GeV after symmetry breaking, using these values we get
\begin{align}
	m_- \approx 10^{-11}\text{GeV} \approx 10^{-2} \text{eV}
\end{align}
which seems \cite{neutrino-mass} to be a reasonable order of magnitude estimate for the observed neutrino
mass.
This mechanism would also lead to supermassive neutrinos, which are a possible dark matter
candidate.
\subsection{Majorana fermions}
A theory that's also quite interesting is that
neutrinos are majorana,
a dirac fermion has the following density:
\begin{align}
  \mathcal{L} &= i\bar{\psi}\slashed{\partial}\psi - m\bar{\psi}\psi\\
              &= i\bar{\psi}_L\slashed{\partial}\psi_L + i\bar{\psi}_R\slashed{\partial}\psi_R - m\bar{\psi}_R\psi_L - m\bar{\psi}_L\psi_R
\end{align}
Now assume that we only have right-handed particles:
\begin{equation}
  \mathcal{L} = i\bar{\psi}_R\slashed{\partial}\psi_R - \frac{M}{2}\bar{\psi}_R\psi_{Rc} - \frac{M}{2}\bar{\psi}_{Rc}\psi_R
\label{eqn:right-handed}
\end{equation}
A majorana fermion is a fermion which is it's own anti-particle, i.e:
\begin{align}
  \chi = \frac{1}{\sqrt{2}}\left( \psi_R + \psi_{Rc}  \right) = \chi_c
\end{align}
With this we have that
\begin{equation}
  \bar{\chi}\chi = \frac{1}{2}\left(\bar{\psi}_R\psi_{Rc} + \bar{\psi}_{Rc}\psi_R\right)
\end{equation}
Which we can recognize in \ref{eqn:right-handed} and
\begin{align}
  \bar{\chi}\slashed{\partial}\chi &= \frac{1}{2}(\bar{\psi}_R + \bar{\psi}_{Rc}) \slashed{\partial}(\psi_R + \psi_{Rc})\\
                                   &= \frac{1}{2} \bar{\psi}_R\slashed{\partial}\psi_R + \frac{1}{2}\bar{\psi}_{Rc}\slashed{\partial}\psi_{Rc}\\
                                   &= \bar{\psi}_R \slashed{\partial}\psi_R
\end{align}
where we've used integration by parts at the end, with these we can re-write \ref{eqn:right-handed} as:
\begin{equation}
  \mathcal{L} = i\bar{\chi}\slashed{\partial}\chi - M \bar{\chi}\chi
\end{equation}
Thus arriving at a density for Majorana fermions with mass M, a possible detection mechanism
to find out if neutrinos are Majorana is "Neutrinoless double beta decay":
\begin{figure}[h!]
	\begin{minipage}{\textwidth}
		\begin{minipage}{0.49\textwidth}
			\centering
			\begin{tikzpicture}
				\begin{feynman}
					\vertex (a0) {\(n\)};
					\vertex[right=3cm of a0] (a1) {\(p^+\)};
					\vertex[right=1.5cm of a0] (am);
					\vertex[right=0.5cm of am] (awi);
					\vertex[above=1cm of awi] (aw);
					\vertex[right=1cm of aw] (avm);
					\vertex[above=0.3cm of avm] (av1) {\(\bar{\nu}_e\)};
					\vertex[below=0.3cm of avm] (av0) {\(e^-\)};
					
					\vertex[above=3.7cm of a0] (b0) {\(n\)};
					\vertex[right=3cm of b0] (b1) {\(p^+\)};
					\vertex[right=1.5cm of b0] (bm);
					\vertex[right=0.5cm of bm] (bwi);
					\vertex[below=1cm of bwi] (bw);
					\vertex[right=1cm of bw] (bvm);
					\vertex[above=0.3cm of bvm] (bv1) {\(\bar{\nu}_e\)};
					\vertex[below=0.3cm of bvm] (bv0) {\(e^-\)};
					
					\diagram* {
						{[edges=fermion]
							(a0) -- (am) -- (a1)
						},
						{[edges=boson,edge label= W]
							(am) -- (aw)
						},
						{(av1) -- [fermion] (aw) --[fermion] (av0)},
						
						{[edges=fermion]
							(b0) -- (bm) -- (b1)
						},
						{[edges=boson,edge label= W]
							(bm) -- (bw)
						},
						(bv1) -- [fermion] (bw) --[fermion] (bv0),
						
					};
				\end{feynman}
			\end{tikzpicture}
		\end{minipage}
		\begin{minipage}{0.49\textwidth}
			\centering
			\begin{tikzpicture}
				\begin{feynman}
					\vertex (a0) {\(n\)};
					\vertex[right=3cm of a0] (a1) {\(p^+\)};
					\vertex[right=1.5cm of a0] (am);
					\vertex[right=0.5cm of am] (awi);
					\vertex[above=1cm of awi] (aw);
					\vertex[right=1cm of aw] (avm);
					\vertex[above=0.85cm of aw] (av1);
					\vertex[below=0.3cm of avm] (av0) {\(e^-\)};
					
					\vertex[above=3.7cm of a0] (b0) {\(n\)};
					\vertex[right=3cm of b0] (b1) {\(p^+\)};
					\vertex[right=1.5cm of b0] (bm);
					\vertex[right=0.5cm of bm] (bwi);
					\vertex[below=1cm of bwi] (bw);
					\vertex[right=1cm of bw] (bvm);
					\vertex[below=0.85cm of bw] (bv1);
					\vertex[above=0.3cm of bvm] (bv0) {\(e^-\)};
					\vertex[below=0.6cm of bw] (ann) {X};
					
					\diagram* {
						{[edges=fermion]
							(a0) -- (am) -- (a1)
						},
						{[edges=boson,edge label= W]
							(am) -- (aw)
						},
						{(av1) -- [fermion] (aw) --[fermion] (av0)},
						
						{[edges=fermion]
							(b0) -- (bm) -- (b1)
						},
						{[edges=boson,edge label= W]
							(bm) -- (bw)
						},
						(bv1) -- [fermion] (bw) --[fermion] (bv0),
						
					};
				\end{feynman}
			\end{tikzpicture}
		\end{minipage}
	\end{minipage}
	\caption{normal and neutrinoless double beta decay}
\end{figure}\\
This is (at the time of writing) actively investigated.
\section{Why study neutrinos?}
%The radio detection of neutrinos targets the energy range 10PeV to 100EeV\cite{Aguilar_2021} 
Neutrinos are ideal messengers to identify the UHE (Ultra High Energy) sources
in the universe. Unlike cosmic rays, which are deflected by magnetic fields and
interact with matter and radiation on their way to us, neutrinos point back to
sources and can reach Earth unperturbed from the most distant corners of the
universe.  Neutrinos can be generated in 2 ways: either they're generated in
interactions at the sources, termed \textit{astrophysical neutrinos}. Or
they're created through the interaction of ultra-high energy cosmic rays during
propagation with the cosmic microwave or other photon backgrounds termed
\textit{cosmogenic neutrinos}. 
\subsection{astrophysical neutrinos: general}
As cosmic rays get accelerated they will occasionally interact with matter
and photon fields near the source. These will then produce new particles,
of which the most common is pions due to their low mass (a lot of available 
phase space). As seen in chapter \ref{chapter:EWTheory} pions can decay
into neutrino's as follows:
\begin{eqnarray}
	\pi^- &\rightarrow \mu^- + \bar{\nu}_\mu \rightarrow e^- + \bar{\nu}_e + \nu_\mu + \bar{\nu}_\mu\\
	\pi^+ &\rightarrow \mu^+ + \nu_\mu \rightarrow e^+ + \nu_e + \bar{\nu}_\mu + \nu_\mu
\end{eqnarray}
Another possibility is direct production of neutrino's at the source, of which Supernovae are
a prime example:
\subsection{Supernovae}
A star starts its life as a ball of pure hydrogen. At the core, due to the
gravitational pressure of the outside plasma, fusion of hydrogen into deuterium
and helium happens. Thus converting mass into energy. The pressure of this energy
counteracts the pressure of gravity and the star is stable.

When the hydrogen at the core runs out no more hydrogen can be fused. For
stars with masses between $8M_\odot$ and $30M_\odot$ the
fusion of heavier elements starts, this can't keep going on however as at some
point the star starts to form the most stable element: iron. 
\begin{figure}[!ht]
	\centering
	\includegraphics[width=0.5\textwidth]{Binding_energy_curve.png}
\end{figure}
It costs energy
to both make lighter elements than iron and heavier ones.  As the iron core
builds up the outside pressure from the core starts to decrease as no new
energy is released. This goes on until  the treshold of an iron core with a mass of 1.4$M_\odot$ known as the 
Chandrasekhar limit and the the inwards pressure becomes too large, making the electrons surrounding the 
iron core fuse with the protons (uud),  creating neutrons (udd) and neutrino's, diagramatically:
\begin{figure}[!ht]
	\centering
	\begin{tikzpicture}
	\begin{feynman}
	\vertex (a0){u};
	\vertex[right=2cm of a0] (am) ;
	\vertex[right=2cm of am] (a1) {d};
	\vertex[above=2cm of am] (bm);
	\vertex[above=2cm of a0] (b0){$e^-$};
	\vertex[right=2cm of bm] (b1){$\nu_e$};
	\diagram* {
		{[edges=fermion]
			(a0) -- (am) -- (a1)
		},
		{[edges=fermion]
			(b0) -- (bm) -- (b1)
		},
		{[edges=boson,edge label=$W^+$]
			(am) -- (bm)
		}
	};
	\end{feynman}
	\end{tikzpicture}
\end{figure}\\
This last part happens in a split second as the collapse goes at 25\% the speed of light, 
creating a very dense neutron star (3000km in diameter iron core to 30km in diameter neutron star) 
and up to $10^{52}$ ultra-relativistic neutrinos, carrying up to 99\% of the
released energy \cite{Melson_2015}\footnote{1\% is released as kinetic energy, only 0.001\% as electromagnetic radiation}.
As the density has suddenly
increased so much there's a huge distance of pure vaccuum between the plasma
outer layer and the (now) neutron star, this plasma starts free-falling inwards, 
also at 25\% the speed of light whilst the neutrinos carrying tremendous amounts 
of energy start going outwards from the neutron stars core.

The neutrinos then collide with the plasma resulting in what we observe as a "supernova", wrongly
thought of by Kepler as being a "new (nova) star" rather being a violent death
of an old star.

This is quite unexpected as neutrinos rarely interact, they only do becouse the
incoming plasma is so dense and due to the tremendous amount of neutrinos that 
collissions happen at all. Some, however, escape and will be visible on earth in 
our neutrino detectors $\approx$ 18h before the light escapes the exploding star.

Neutrino observatories are thus useful to know where to point our various
telescopes before the supernova is actually visible in the night sky.
\subsection{primordial neutrinos}
Aside from all the previously mentioned sources, there's also a less spectacular source of 
neutrinos: the neutrino version of the CMB.
We can estimate the temperature of the neutrinos who decoupled at the start of the universe, 
for this we can take a look at conservation of entropy \cite{Dodelson}
\begin{equation}
	T_\nu = \left(\frac{4}{11}\right)^{1/3}T_\gamma
\end{equation}
\subsection{How do they fit into the full detector spectrum?}
The origin of the most energetic cosmic rays is still not conclusively
identified. One approach to solving this problem is \textit{multi-messenger
astrophysics}, where several types of cosmic particles are used to identify the
sources of these ultra-high energy cosmic rays (UHECRs). E.g we simultaneously
measure gravitational waves (gravitons?) with the Einstein telescope,
neutrino's with IceCube (or eventually RNO-G), photons with various telescopes
and muons with a muon detector.
\newpage
\chapter{Radio detection of neutrinos}
\section{Neutrino interactions in ice}
As neutrinos propagate through ice they can interact with nuclei in the following ways\cite{NuRadioMc}:
\begin{figure}[h!]
	\begin{minipage}{\textwidth}
		\begin{minipage}{0.49\textwidth}
			\centering
			\begin{tikzpicture}
				\begin{feynman}
					\vertex (a0) {quark};
					\vertex[above=0.5cm of a0] (a1) {quark};
					\vertex[above=0.5cm of a1] (a2) {quark};
					\vertex[right=2cm of a0] (b0) {quark};
					\vertex[right=2cm of a1] (b1) {quark};
					\vertex[right=2cm of a2] (b2) {quark};
					\vertex[right=1.0cm of a2] (am);
					\vertex[above=1cm of am] (c0);
					\vertex[above=1cm of c0] (c1);
					\vertex[above=1cm of c1] (cm);
					\vertex[left=1cm of cm] (a3) {$\nu_l$};
					\vertex[right=1cm of cm] (b3) {$l$};
					\diagram* {
						{[edges=fermion]
							(a0) -- (b0)
						},
						{[edges=fermion]
							(a1) -- (b1)
						},
						{[edges=fermion]
							(a2) -- (c0) -- (b2)
						},
						{[edges=fermion]
							(a3) -- (c1) -- (b3)
						},
						{[edges=boson, edge label=W]
							(c0) -- (c1)
						},
					};
				\end{feynman}
			\end{tikzpicture}
		\end{minipage}
		\begin{minipage}{0.49\textwidth}
			\centering
			\begin{tikzpicture}
				\begin{feynman}
					\vertex (a0) {quark};
					\vertex[above=0.5cm of a0] (a1) {quark};
					\vertex[above=0.5cm of a1] (a2) {quark};
					\vertex[right=2cm of a0] (b0) {quark};
					\vertex[right=2cm of a1] (b1) {quark};
					\vertex[right=2cm of a2] (b2) {quark};
					\vertex[right=1.0cm of a2] (am);
					\vertex[above=1cm of am] (c0);
					\vertex[above=1cm of c0] (c1);
					\vertex[above=1cm of c1] (cm);
					\vertex[left=1cm of cm] (a3) {$\nu$};
					\vertex[right=1cm of cm] (b3) {$\nu$};
					\diagram* {
						{[edges=fermion]
							(a0) -- (b0)
						},
						{[edges=fermion]
							(a1) -- (b1)
						},
						{[edges=fermion]
							(a2) -- (c0) -- (b2)
						},
						{[edges=fermion]
							(a3) -- (c1) -- (b3)
						},
						{[edges=boson, edge label=Z]
							(c0) -- (c1)
						},
					};
				\end{feynman}
			\end{tikzpicture}
		\end{minipage}
	\end{minipage}
	\caption{Most prominent ways of neutrino-nucleus interaction}
\end{figure}\\
With the produced leptons in the W boson mediated interaction being either electrons,
resulting in an electromagnetic shower, muons wich typically go undetected as they live
too long or
tauons wich will decay via
\begin{equation}
	\tau^- \rightarrow e^- + \bar{\nu}_e + \nu_\tau
\end{equation}
or, less ideally
\begin{equation}
	\tau^- \rightarrow \mu^- + \bar{\nu}_\mu + \nu_\tau
\end{equation}
In both of the possible interactions the resulting nucleus will result in a 
hadronic shower, for the neutral current interaction (mediated by the Z boson) 
the fraction of the neutrino energy that gets transferred to the nucleon
is described by the inelasticity $y$ and is heavily shifted towards small
values of $y$\cite{elasticity_y}. This causes a big, irreducable uncertainty
when trying to estimate the original
neutrino energy from these kinds of events. 
With the charged current interaction (mediated by the $W^\pm$ bosons) this 
isn't a problem however as the full neutrino energy
ends up in the resulting cascades.
\section{Askaryan effect}
For a particle shower to emit strong radio signals, two conditions have to be met:
\begin{itemize}
	\item There needs to be a speration of positive and negative charges in the shower front 
	\item The signals produced over the length of the shower profile need to overlap coherently.
\end{itemize}
The \textit{Askaryan} \cite{Askaryan} effect, also known as Askaryan
radiation describes the effect at radio frequencies which abides by both 
of these conditions, in general it's a quite difficult effect but we'll give 
a crude overview. 
The above described interactions create a shower
of secondary charged particles containing a charge anisotropy, 
this charge imbalance is a result of medium electrons either Compton
scattering into the advancing shower or annihilating with shower positrons. 
In the end you have a moving charge anisotropy, propagating faster than the speed of 
light in the medium,
creating Cherenkov radiation.
Cherenkov radiation is like the elektromagnetic equivalent of a sonic boom, a
sonic boom happens when something goes faster than the sounds speed in the
medium; A particle emits Cherenkov radiation if it goes faster than the light
speed in the medium\footnote{The reader who wants a thorough explanation and derivation is
advised to check out \textit{Chapter 14: Radiation by Moving Charges} from the
book \textit{Classical Electrodynamics} by Jackson.} 
. Choosing the particle trajectory to lie along the z axis
we can approximately find an equation for $\frac{\text{d}^2 \mathscr{J}}{\text{d}\omega \text{d}\Omega}$: the energy radiated per elementary unit solid angle and per elementary unit frequency interval
\begin{equation}
	\frac{\text{d}^2 \mathscr{J}(\omega)}{\text{d} \omega \text{d} \Omega} = \frac{q^2}{4\pi}\sqrt{\frac{\mu}{\epsilon}}\beta^2\omega^2\delta^2[\omega(1-\beta \mathbf{e}_r\cdot\mathbf{e}_z)]|\mathbf{e}_r\times\mathbf{e}_z|^2 \label{equation: 4.128 in elektromagnetisme}
\end{equation}
Now we can re-write this equation in spherical coordinates, which gives $1-\beta \mathbf{e}_r\cdot\mathbf{e}_z = 1-\beta\cos(\theta_c)$ in the delta function. We thus only expect radiation if
\begin{equation}
\cos(\theta_c) = \frac{1}{\beta} = \frac{c'}{u} = \frac{c}{n}\cdot\frac{1}{u}
\end{equation}
I.e if $u>\frac{c}{n}$ with n the index of refraction, Cherenkov radiation will be emitted along a cone surface with half angle $\frac{\pi}{2}-\theta_c$ as illustrated in figure \ref{figure: Cherenkov illustratie}. Integrating equation \ref{equation: 4.128 in elektromagnetisme} over the solid angle and formally deviding by the time interval we get:
\begin{equation}
	\frac{\text{d}^2\mathscr{J}}{\text{d}\omega \text{d}t} = \frac{q^2}{4\pi}\sqrt{\frac{\mu}{\epsilon}}\beta\omega\left(1-\frac{1}{\beta^2}\right)	
\end{equation}
We see that the energy is proportional to $\omega$, so we expect that most
radiation will be emitted "in blue", as seen in figure \ref{figure: Cherenkov
reactor}.  For ice the index of refraction is roughly 1.78 in deep ice, so we
expect an ultra-relativistic particle to produce the most radiation at around
56° opening as 
\begin{equation}
	\cos(\theta_c) \approx \frac{1}{n} \implies \cos^{-1}\left(\frac{1}{1.78}\right)\approx 56\text{°}
\end{equation}
\begin{figure}
\centering
\begin{minipage}{0.45\textwidth}
	\centering
	\copyrightbox[r]{\includegraphics[height = 0.8\textwidth]{Cherenkov-reactor.jpg}}{\textcopyright Argonne National Laboratory\\Advanced Test Reactor core, Idaho National Laboratory}
	\caption{Cherenkov radiation in a nuclear reactor}
	\label{figure: Cherenkov reactor}
\end{minipage}
\hspace{0.05\textwidth}
\begin{minipage}{0.45\textwidth}
	\centering
	\copyrightbox[r]{\includegraphics[height = 0.8\textwidth]{Cherenkov.pdf}}{\textcopyright Arpad Horvath}
	\caption{Diagrammatic representation of Cherenkov radiation}
	\label{figure: Cherenkov illustratie}
\end{minipage}
\end{figure}
Of course this is just an estimate, as the actual index of refraction is depth-dependent which
we'll get to in section (...).
Now this explains how the signals get generated but logically, from only knowing this
we'd expect radio waves to almost be non-existent 
due to the "in blue" nature of Cherenkov radiation. 
This isn't the full story however as we'll need to talk about coherent overlap
to fully understand the Askaryan effect. This can be intuitively explained as
follows: generally the shower is of length
$\mathcal{O}$(10cm)\cite{Huege_2017}, over this length the radiation gets
emitted, most frequencies decoherently interfering, but radio waves with wavelengths of 
$\approx$ 10cm coherently interfere, and it's these waves we then wish to detect.
\section{Wave propagation}
Waves propagating through ice to a detector generally looks something like this:
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.7\textwidth]{Path_illu.pdf}
\end{figure}\\
Here the interaction of the neutrino happens somewhere in the neighbourhood of the red cross,
the orange rays represent the resulting radio wave paths to the detectors which are signaled
by the blue dot. Notice that reflection at the surface is also a possible path to the detector.
To figure out how these rays propagate, we can take a look at the eikonal equation:
a path of a ray $\mathbf{r}(s)$ with path parameter s in a medium with index of
refraction n($\mathbf{r}$) is described by:
\begin{equation}
	\frac{d}{ds}\left(n(\mathbf{r})\frac{d\mathbf{r}}{ds}\right) = \nabla n
\end{equation}
The module we'll be using for ray reconstruction is called "radiopropa" \cite{radiopropa}
and in the radiopropa software the local paraxial approximation is used, i.e. assuming 
that in any individual step of the algorithm the change of the refractive index along the 
path ds is small (treating boundary effects like reflections on the surface seperately)
making it possible to re-write the equation as:
\begin{equation}
n(\mathbf{r})\frac{d^2\mathbf{r}}{ds^2} \approx \nabla n
\end{equation}
Which is then easily iteratively solved.
\section{Reconstruction}
It can pose a challenge to reconstruct the radio signals produced by the
Cherenkov radiation as they are often obscured by background noise. A solution
used in RadioReco is Information Field Theory (IFT) implemented in RadioReco by
Welling et al.\cite{Welling_2021} which uses Bayesian inference to calculate
the most likely radio signal, given recorded data.
The full reconstruction will then work as follows: events and their propagation
are generated in a monte-carlo simulation
using NuRadioMC\cite{Glaser_2019}\cite{Glaser_2020}, how the detector signals would look 
like is then simulated with RadioReco and saved in a database. 
If we then detect a neutrino event in the real detector it can
be compared to the database, thus finding the origin.
\chapter{The Detector}
\begin{figure}
	\centering
	\copyrightbox[r]{\includegraphics[height = 0.3\textheight]{cosmic_ray_flux.pdf}}{\textcopyright Cosmic rays and particle physics by Caiser, Engel and Resconi}
	\caption{Falling cosmic ray flux with energy}
	\label{figure:FallingFlux}
\end{figure}
Both cosmic ray and neutrino detectors face the same main problem at the
highest energies: the steeply falling flux (as can be seen on figure \ref{figure:FallingFlux}) 
requires large effective areas, which
leads to the construction of neutrino detectors with volumes on the cubic
kilometer scale: IceCube. As we wish to detect neutrino's with even higher
energies we turn to look at an array of detectors spanning multiple cubic
kilometers: RNO-G.

One such detector is illustrated in figure \ref{fig:detector}.

The deep component of the detector can be split up in three parts: Two \textit{helper strings}, one \textit{power string} and the surface components. The helper strings are the 2 vertical cables shown on the right of the figure and each one houses 2 vertically polarized antennas (Vpols), one quadslot antenna for the horizontal polarization component (Hpol) and one radio pulser on each helper string which can be used to generate calibration signals.

The power string (the leftmost vertical cable) is more densely instrumented: At the bottom it houses a set of four Vpol and two Hpol antennas with a spacing of 1m and further up the string, with a spacing of 20m are three more Vpol antennas.

The signal from each of these antennae are fed into a low-noise amplifier directly above it, from there the signal is send to the data acquisition (DAQ) system at the surface via a Radio Frequency over Fiber (RFoF) cable. There it's again amplified, digitized and saved onto an SD card. This data is then transmitted via a Long Term Evolution (LTE) telecommunications network to a local server\footnote{There is additionally a Long Range Wide Area Network (LoRaWAN) antenna as backup in case of problems with the LTE network}, from where it is sent via a sattelite link.

There are solar panels as a power source who charge up battery banks, but as there is't enough light during the Greenland winters, there're plans to build wind turbines (with the problem being the possibly detectable RF noise the 'engine' produces)

\begin{figure}
	\includegraphics[width=0.9\textwidth]{figures/detector.pdf}	
	\caption{illustration of the detector}
	\label{fig:detector}
\end{figure}
\newpage
The radio signal from a neutrino often travels along both direct and refracted paths (designated DnR) to the deep array, this happens because the upper ice layer is a non-uniform medium where the signal trajectory is bent, as illustrated by a simulation in figure \ref{fig:path_illustration}. 

\begin{figure}
	\centering
	\includegraphics[width=0.8\textwidth]{figures/path_illustration.png}	
	\caption{illustration of a neutrino signal path, the neutrino interaction 
	being located at (0,-100) and the detector at (90,-7)}
	\label{fig:path_illustration}
\end{figure}


This double pulse characteristic would be a smoking-gun signature of an in-ice
source. The two helper strings are needed for a full direction reconstruction.
Three independent measurements are needed for azimuthal information, which is
provided by the Vpol (Vertical polarization) antennas and placing the Hpol
(Horizontal polarization) antennas at different depths on every string, both
zentih and azimuth information will be provided for those signals. The helper
strings' calibration pulsers, as well as one on the surface, will ensure
regular monitoring of the performance of the station and provide information
useful for precise calibration of the antenna geometry.

The plan is to construct these detectors in an array as shown in figure 
\ref{fig:station map}, note that all the individual detectors are named after
various species living in greenland (in the native tongue).

Christoph Welling did an investigation into energy reconstruction from the
received signals\cite{Welling_2019} for air showers in one single station (as
the RNO-G stations are so far apart this is the case here aswell) and he
noticed that it is nescessary to know if the detector who observes an event
falls inside or outside the Cherenkov cone to accurately reconstruct the
primary particle energy as most over-estimated energies in his simulations are
caused by events viewed from within the Cherenkov ring being mistaken for
events outside of it. He went on to show that, if we somehow know if the shower
was seen from inside or outside the ring from some extra source, that most
outliers in the energy disappeared. It is shown by Hiller et
al.\cite{Hiller_2017} that the combination of a muon detector with the radio
detector might make the issue of confusion between being within or outside of
the Cherenkov-ring disappear. Because of this the RNO-G stations are fitted
with surface Log Periodic Dipole Antennas (LPDA), capable of detecting muons.
Note that this is for air showers, the radio signal from neutrinos show
additional complexities.

\begin{figure}
	\includegraphics[width=\textwidth]{figures/station-map.png}	
	\caption{map of the station}
	\label{fig:station map}
\end{figure}

\chapter{Hybrid Ray tracer}
%----------------------------------------------------------------------------------------
%	HYBRID RAY TRACER	
%----------------------------------------------------------------------------------------
\section{Exponential ice model}
Ice has a 
\section{Need for other ice models}
It has become apparent [citation needed] that complex ice models will be nescessary moving forward 
as the exponential ice model fails to fit the density curve. 
The ideal software for radio wave propagation through
ice is radiopropa\cite{Winchen_2019}, but due to the way it works you'll have
to know the start point , the end point and the launch angle of your ray to
work out the path. With the exponential model the launch angle is known from solving a simple 
equation.
However for a more difficult ice model the launch angle can't be know a priori.
Work has been done on this by B. Oeyen et al. \cite{2022icrc.confE1027O}, 
where they created a ray tracer which iteratively finds the solution, 
called the "iterative ray tracer".
The full explanation of how their algorithm works can be found in the mentioned paper. 
This is however a sub-optimal solution in python as an optimalisation library 
will generally work faster, work
had been done on trying to implement such an algorithm but this attempt failed.
As I saw this work I had an idea to combine the iterative ray tracer and the code using the 
optimisation libraries (a so called "minimizer"), to come up with the algorithm that will 
be discussed in this chapter: The hybrid ray tracer, in the source code called the "hybrid
minimizer".

It succeeds in more rapidly tracing the path from the event
to the detector, is more accurate and also arrives closer to the detector as the final result is
not limited by the final drawn sphere size but by a given tolerence.

\section{How it works}
\begin{figure}[h!]
	\centering
	\includegraphics[width=\textwidth]{figures/explanation.png}
	\caption{explanation of the hybrid method}
	\label{fig:explanation}
\end{figure}
The hybrid minimizer can be seen as an extension of the iterative raytracer, it
checks after the first loop (as explained in the paper by B. Oeyen et al.
\cite{2022icrc.confE1027O}) if there are 2 distinct launch regions, if this is
the case it breaks out of the loop 
as is visually explained using a modified version of B. Oeyen et al. their figure in the top
part of figure \ref{fig:explanation}. 
It then goes on to use the scipy.optimize.minimize module
to find the solutions in the respective angle intervals
as shown in the bottom part of figure \ref{fig:explanation} (minimizing $\Delta z$). If it doesn't find 2
distinct regions after the first loop, it falls back on the iterative ray tracer. 
\section{random number generator}
To test the hybrid minimizer the numpy random module was used to generate
random coördinates, the considered square (as there is only a z component to the
ice model the 3D problem is essentially only a 2D problem) is x:0.1km,4km and
z:-0.1km,-3km.\footnote{This start at 100m depth was to get around issues concerning events that 
won't even trigger in a full simulation}
\section{Performance Optimalisation}
\subsection{Length of the normal vector}
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.7\textwidth]{figures/PrincipleNormIllu.pdf}
	\caption{how normal vector size influences the stepsize}
	\label{fig:normexpl}
\end{figure}
As visually explained in figure \ref{fig:normexpl}, the size of the normal vector seems to
influence how big the ray tracer's step size is taken close to the detector. This
thus influences the convergence and time taken. The results of varying this are shown
in figures \ref{fig:norminfl} and \ref{fig:norminfl2}.
Looking at these figures the first optimization conclusion is as expected: 
take the normal vector length to be 1 meter.
\subsection{ztol}
We'll now change the tolerence on the vertical distance away from the detector which is deemed
accepted i.e in figure \ref{fig:normexpl} if $\Delta z$ is below this threshold it's accepted.
The results are shown in figures \ref{fig:ztolinfl} and \ref{fig:ztolinfl2}.
From which we can conclude the second optimization conclusion: take ztol to be 0.05 m.
\subsection{Sphere Size \& Step Size}
As explained in Oeyen et al.'s work, the initial rays are sent out in steps of a
certain angle and with a sphere around the detector (as can also be seen at the top of
figure \ref{fig:explanation}, but for clarification I again refer to their
paper). The sphere size and step size weren't jet optimized. But as
this is the slowest step in the hybrid ray tracer this was optimized here (only
the initial sphere and step size as those are relevant for the hybrid
raytracer) as seen in figures \ref{fig:SphereStepInfl} and \ref{fig:SphereStepFinal}.

\begin{figure*}
	\centering
\begin{minipage}{0.49\textwidth}
	\includegraphics[width=1.1\textwidth]{figures/hybrid_comparison_N_1000.pdf}
	\caption{Hybrid}
	\label{fig:acchyb}
\end{minipage}
\begin{minipage}{0.49\textwidth}
	\includegraphics[width=1.1\textwidth]{figures/iterative_comparison_N_1000.pdf}
	\caption{Iterative}
	\label{fig:accit}
\end{minipage}
\end{figure*}

\begin{figure}
	\centering
	\begin{minipage}{\textwidth}
		\includegraphics[width=0.8\textwidth]{figures/NormVsTime.pdf}
	\end{minipage}
	\begin{minipage}{\textwidth}
		\includegraphics[width=0.8\textwidth]{figures/NormVsSigmaTime.pdf}
	\end{minipage}
\caption{influence of the length of the normal vector}
\label{fig:norminfl}
\end{figure}
\begin{figure}
	\centering
	\begin{minipage}{\textwidth}
		\includegraphics[width=0.8\textwidth]{figures/NormVsTime.pdf}
	\end{minipage}
	\begin{minipage}{\textwidth}
		\includegraphics[width=0.8\textwidth]{figures/NormVsSigmaAZ.pdf}
	\end{minipage}
\caption{influence of the length of the normal vector}
\label{fig:norminfl2}
\end{figure}

\begin{figure}
	\centering
	\begin{minipage}{\textwidth}
		\includegraphics[width=0.8\textwidth]{figures/ZtolVsTime2.pdf}
	\end{minipage}
	\begin{minipage}{\textwidth}
		\includegraphics[width=0.8\textwidth]{figures/ZtolVsSigmaTime.pdf}
	\end{minipage}
\caption{influence of the tolerence on vertical distance}
\label{fig:ztolinfl}
\end{figure}

\begin{figure}
	\centering
	\begin{minipage}{\textwidth}
		\includegraphics[width=0.8\textwidth]{figures/ZtolVsTime2.pdf}
	\end{minipage}
	\begin{minipage}{\textwidth}
		\includegraphics[width=0.8\textwidth]{figures/ZtolVsSigmaAZ.pdf}
	\end{minipage}
\caption{influence of the tolerence on vertical distance}
\label{fig:ztolinfl2}
\end{figure}

\begin{figure}
	\includegraphics[width=\textwidth]{figures/subplotofallstepsphere.pdf}
	\caption{Variation in Sphere and angle step size with report on relative time.}
	\label{fig:SphereStepInfl}
\end{figure}

\begin{figure}
	\includegraphics[width=\textwidth]{figures/SphereAndStepFinal.pdf}
	\caption{Green values in variation in sphere and angle step size with report on relative time.}
	\label{fig:SphereStepFinal}
\end{figure}

\chapter{Weather Balloon}
There are some changes that need to be made to the established hybrid minimizer, first off the air observer needs
to be hard removed as to make the simulation possible, second off the extra air observer needs to be removed that's additionally
defined for some reason and thirdly, the boundary behind the detector is now no longer vertical but horizontal.

Now having established this the first problem we'll consider is plane wave reconstruction of the original position, an example path to some of the sensors
is given in figure (...)
\begin{figure}
	\centering
	\includegraphics[width=0.7\textwidth]{weerballontraject.png}
\end{figure}
\begin{figure}
	\centering
	\includegraphics[width=0.7\textwidth]{planewave.pdf}
\end{figure}
\begin{equation}
	\Delta t' = \frac{m}{(m/s)} = (s/m)*m = v^{-1} * m = \frac{c}{n} \cos\theta \Delta z
\end{equation}
We take n to be 1.78 as 
%# from C. Deaconu, fit to data from Hawley '08, Alley '88
%# rho(z) = 917 - 602 * exp (-z/37.25), using n = 1 + 0.78 rho(z)/rho_0

\begin{equation}
	Correlation = \Delta t - \frac{\cos\theta \Delta z}{v}
\end{equation}

\begin{figure}
	\includegraphics[width=\textwidth]{WeatherBalloonPath.png}
\end{figure}

% =====================================================================
% End matter
% =====================================================================
\newpage
%----------------------------------------------------------------------------------------
%	REFERENCE LIST
%----------------------------------------------------------------------------------------
\bibliography{sources}
\bibliographystyle{plain}

\end{document}
